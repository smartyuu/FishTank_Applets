import{watch as t,unref as n,inject as e,computed as o,watchEffect as r,Vue2 as i,defineComponent as a,shallowRef as u,toRefs as c,getCurrentInstance as l,onMounted as s,onBeforeUnmount as v,h as f,nextTick as p}from"vue-demi";import{throttle as d,init as g}from"echarts/core";import{addListener as h,removeListener as O}from"resize-detector";var m=function(){return m=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t},m.apply(this,arguments)},b=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function j(t){return n=Object.create(null),b.forEach((function(e){n[e]=function(n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(!t.value)throw new Error("ECharts is not initialized yet.");return t.value[n].apply(t.value,e)}}(e)})),n;var n}var y={autoresize:[Boolean,Object]},_=/^on[^a-z]/,z=function(t){return _.test(t)};function x(t,e){var o=n(t);return o&&"object"==typeof o&&"value"in o?o.value||e:o||e}var E="ecLoadingOptions";var L={loading:Boolean,loadingOptions:Object};i&&i.config.ignoredElements.push("x-vue-echarts");var A="ecTheme",U="ecInitOptions",w="ecUpdateOptions",D=a({name:"echarts",props:m(m({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},y),L),emits:{},inheritAttrs:!1,setup:function(n,i){var a=i.attrs,f=u(),b=u(),y=u(),_=e("ecTheme",null),E=e("ecInitOptions",null),L=e("ecUpdateOptions",null),A=c(n),U=A.autoresize,w=A.manualUpdate,D=A.loading,C=A.loadingOptions,P=o((function(){return y.value||n.option||null})),B=o((function(){return n.theme||x(_,{})})),R=o((function(){return n.initOptions||x(E,{})})),T=o((function(){return n.updateOptions||x(L,{})})),k=o((function(){return function(t){var n={};for(var e in t)z(e)||(n[e]=t[e]);return n}(a)})),I=l().proxy.$listeners;function S(t){if(f.value){var e=b.value=g(f.value,B.value,R.value);n.group&&(e.group=n.group);var o=I;o||(o={},Object.keys(a).filter((function(t){return 0===t.indexOf("on")&&t.length>2})).forEach((function(t){var n=t.charAt(2).toLowerCase()+t.slice(3);"Once"===n.substring(n.length-4)&&(n="~".concat(n.substring(0,n.length-4))),o[n]=a[t]}))),Object.keys(o).forEach((function(t){var n=o[t];if(n){var r=t.toLowerCase();"~"===r.charAt(0)&&(r=r.substring(1),n.__once__=!0);var i=e;if(0===r.indexOf("zr:")&&(i=e.getZr(),r=r.substring(3)),n.__once__){delete n.__once__;var a=n;n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];a.apply(void 0,t),i.off(r,n)}}i.on(r,n)}})),U.value?p((function(){e&&!e.isDisposed()&&e.resize(),r()})):r()}function r(){var n=t||P.value;n&&e.setOption(n,T.value)}}function F(){b.value&&(b.value.dispose(),b.value=void 0)}var H=null;t(w,(function(e){"function"==typeof H&&(H(),H=null),e||(H=t((function(){return n.option}),(function(t,n){t&&(b.value?b.value.setOption(t,m({notMerge:t!==n},T.value)):S())}),{deep:!0}))}),{immediate:!0}),t([B,R],(function(){F(),S()}),{deep:!0}),r((function(){n.group&&b.value&&(b.value.group=n.group)}));var M=j(b);return function(t,n,i){var a=e("ecLoadingOptions",{}),u=o((function(){return m(m({},x(a,{})),null==i?void 0:i.value)}));r((function(){var e=t.value;e&&(n.value?e.showLoading(u.value):e.hideLoading())}))}(b,D,C),function(n,e,o){var r=null;t([o,n,e],(function(t,n,e){var o=t[0],i=t[1],a=t[2];if(o&&i&&a){var u=!0===a?{}:a,c=u.throttle,l=void 0===c?100:c,s=u.onResize,v=function(){i.resize(),null==s||s()};r=l?d(v,l):v,h(o,r)}e((function(){o&&r&&O(o,r)}))}))}(b,U,f),s((function(){S()})),v((function(){F()})),m({chart:b,root:f,setOption:function(t,e){n.manualUpdate&&(y.value=t),b.value?b.value.setOption(t,e||{}):S(t)},nonEventAttrs:k},M)},render:function(){var t=i?{attrs:this.nonEventAttrs}:m({},this.nonEventAttrs);return t.ref="root",t.class=t.class?["echarts"].concat(t.class):"echarts",f("x-vue-echarts",t)}});export{U as INIT_OPTIONS_KEY,E as LOADING_OPTIONS_KEY,A as THEME_KEY,w as UPDATE_OPTIONS_KEY,D as default};
//# sourceMappingURL=index.esm.min.js.map
